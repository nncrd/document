<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>应急办注册页面</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="alternate icon" type="image/png" href="assets/i/favicon.png">
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/amazeui.min.js"></script>
  <script src="https://malsup.github.io/jquery.form.js" type="text/javascript"></script>
  <script src="https://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
  <script src="https://static.runoob.com/assets/jquery-validation-1.14.0/dist/localization/messages_zh.js"></script>
  <link rel="stylesheet" href="assets/css/amazeui.min.css"/>
  <link rel="stylesheet" href="assets/css/emo.css"/>
  <style>
    .logo {
      margin:1em 0;
      text-align: center;
    }
    img{
      width: 85px;
    }
    label{
      margin-top:.5em
    }   
  </style>
</head>
<body>
  <header data-am-widget="header" class="am-header am-header-fixed am-header-default">
      <div class="am-header-left am-header-nav">
          <a href="event-reporter.html" class="">
              <img class="am-header-icon-custom" src="data:image/svg+xml;charset&#x3D;utf-8,&lt;svg xmlns&#x3D;&quot;http://www.w3.org/2000/svg&quot; viewBox&#x3D;&quot;0 0 12 20&quot;&gt;&lt;path d&#x3D;&quot;M10,0l2,2l-8,8l8,8l-2,2L0,10L10,0z&quot; fill&#x3D;&quot;%23fff&quot;/&gt;&lt;/svg&gt;" alt=""/>
          </a>
      </div>
      <h1 class="am-header-title">
          账号注册
      </h1>
      <div class="am-header-right am-header-nav">
          <a href="#right-link" class="">
              <img class="am-header-icon-custom" src="data:image/svg+xml;charset&#x3D;utf-8,&lt;svg xmlns&#x3D;&quot;http://www.w3.org/2000/svg&quot; viewBox&#x3D;&quot;0 0 42 26&quot; fill&#x3D;&quot;%23fff&quot;&gt;&lt;rect width&#x3D;&quot;4&quot; height&#x3D;&quot;4&quot;/&gt;&lt;rect x&#x3D;&quot;8&quot; y&#x3D;&quot;1&quot; width&#x3D;&quot;34&quot; height&#x3D;&quot;2&quot;/&gt;&lt;rect y&#x3D;&quot;11&quot; width&#x3D;&quot;4&quot; height&#x3D;&quot;4&quot;/&gt;&lt;rect x&#x3D;&quot;8&quot; y&#x3D;&quot;12&quot; width&#x3D;&quot;34&quot; height&#x3D;&quot;2&quot;/&gt;&lt;rect y&#x3D;&quot;22&quot; width&#x3D;&quot;4&quot; height&#x3D;&quot;4&quot;/&gt;&lt;rect x&#x3D;&quot;8&quot; y&#x3D;&quot;23&quot; width&#x3D;&quot;34&quot; height&#x3D;&quot;2&quot;/&gt;&lt;/svg&gt;" alt=""/>
          </a>
      </div>
  </header>
  <div class="logo">
    <img src="assets/i/logo.png" alt="加载中"/>
  </div>
  <div class="am-g">
    <div class="am-u-lg-6 am-u-md-8 am-u-sm-centered">
      <form method="post" class="am-form" id="userRegister" action="">
        <span class="am-icon-globe"></span><label for="area">地区<span class="must">*</span></label>
        <select id="area" class="am-form-select am-input-lg" name="area">
        </select>
        <span class="am-icon-users"></span><label for="department">部门<span class="must">*</span></label>
        <select id="department" class="am-form-select am-input-lg" name="department">
        </select>
        <div>
          <span class="am-icon-user"></span><label for="email">姓名<span class="must">*</span></label>
          <input type="text" name="name" id="name" value="" maxlength="10" placeholder="请输入姓名" class="am-input-lg">
        </div>
        <div>
          <span class="am-icon-mobile-phone"></span><label for="password">手机号<span class="must">*</span></label>
          <input type="text" name="tel" id="phone" value="" placeholder="请输入手机号码" class="am-input-lg">
        </div>
        <br>
        <div class="am-cf">
          <button type="submit" class="submitBtn am-btn am-btn-lg am-center"><span class="am-icon-cloud-upload"></span> 提交信息</button>
        </div>
      </form>
    </div>
  </div>
  <script type="text/javascript">
    $(function () {      
      var progress = $.AMUI.progress;
      var areaList=[{id: 'nn', name: '南宁'}, {id: 'gl', name: '桂林'}, {id: 'lz', name: '柳州'}, {id: 'bh', name: '北海'}, {id: 'wz', name: '梧州'}, {id: 'bs', name: '百色'}, {id: 'fcg', name: '防城港'}, {id: 'qz', name: '钦州'}, {id: 'yl', name: '玉林'}, {id: 'hc', name: '河池'}, {id: 'gg', name: '贵港'}, {id: 'hz', name: '贺州'}, {id: 'cz', name: '崇左'}];
      var departmentList=[{id: 'gtj', name: '国土局'}, {id: 'slj', name: '水利局'}, {id: 'xzf', name: '县政府'}, {id: 'fxb', name: '防汛办'}, {id: 'lyj', name: '旅游局'}, {id: 'jyj', name: '教育局'}, {id: 'zjj', name: '住建局'}, {id: 'jtb', name: '交通局'}, {id: 'ajj', name: '安监局'}, {id: 'glj', name: '公路局'}, {id: 'zzf', name: '镇政府'}, {id: 'rwb', name: '人武部'}, {id: 'qxj', name: '气象局'}];
      for(var i = 0; i< areaList.length; i++){  
        $("<option value='"+areaList[i].id+"'>"+areaList[i].name+"</option>").appendTo("#area");  
      }
      for(var i = 0; i< departmentList.length; i++){  
        $("<option value='"+departmentList[i].id+"'>"+departmentList[i].name+"</option>").appendTo("#department");  
      }
      jQuery.validator.addMethod("isPhone", function(value, element) { 
        var tel = /^(((13[0-9]{1})|(15[0-9]{1}))+\d{8})$/; 
        return this.optional(element) || (tel.test(value)); 
        }, "电话号码格式错误");
      $('#userRegister').validate({
        //提交表单后，（第一个）未通过验证的表单获得焦点 
        focusInvalid:true, 
        //当未通过验证的元素获得焦点时，移除错误提示 
        //focusCleanup:true, 
        // errorClass: "unchecked",
        // validClass: "checked",
        // errorElement: "span",
        submitHandler:function(form){
            $(form).ajaxSubmit({
                type:"post",
                url:"../../wechat/reporter-register",
                beforeSend:function(){
                  progress.start();
                },
                complete:function(){
                  progress.done();
                },
                success: function(data) {
                    if(data.code==0){
                        console.log("注册成功")
                    }
                    else if(data.error==102){
                        console.log("用户已经注册过")
                    }
                    else if(data.error==103){
                        console.log("用户已经被封号")
                    }
                    else if(data.error==-111){
                        console.log("没有获取微信号信息")
                    }
                }
            });
        },
        rules: {
          name:"required",
          phone:{
            isPhone:true,
            required:true,
          },
        },
        messages:{
          name:"请输入用户名",
          phone:{
            required:"请输入手机号码"
          }
        }
      });
    });
  </script>
</body>
</html>
